<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kullanıcı Paneli - Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <link rel="stylesheet" href="KullanıcıSayfa.css" />
    <script></script>
  </head>
  <body>
    <div class="d-flex">
      <!-- Sidebar -->
      <nav id="sidebar">
        <div class="sidebar-header">
          <h3>Kut-AI</h3>
        </div>

        <div class="sidebar-user-info">
          <h5 class="user-username-display">gozdegonul</h5>
          <span class="badge bg-success">Öğrenci</span>
        </div>

        <ul class="sidebar-nav">
          <li>
            <a href="#dashboard" class="active" data-content="dashboard">
              <i class="bi bi-speedometer2"></i> Dashboard
            </a>
          </li>
          <li>
            <a href="#oyun" data-content="oyun">
              <i class="bi bi-joystick"></i> Oyun
            </a>
          </li>
          <li>
            <a href="#raporlar" data-content="raporlar">
              <i class="bi bi-file-text"></i> Raporlar
            </a>
          </li>
          <li>
            <a href="#analizler" data-content="analizler">
              <i class="bi bi-bar-chart"></i> Analizler
            </a>
          </li>
          <li>
            <a href="#anketler" data-content="anketler">
              <i class="bi bi-clipboard-data"></i> Anketler
            </a>
          </li>
        </ul>

        <div class="sidebar-footer">
          <ul class="sidebar-nav">
            <li>
              <a href="#ayarlar" data-content="ayarlar">
                <i class="bi bi-gear"></i> Ayarlar
              </a>
            </li>
            <li>
              <a href="#" id="logout-link">
                <i class="bi bi-box-arrow-right"></i> Çıkış Yap
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <!-- Ana İçerik -->
      <div id="content">
        <!-- Topbar -->
        <div class="topbar mb-4">
          <div class="d-flex align-items-center">
            <a href="javascript:history.back()" class="back-button">
              <i class="bi bi-arrow-left"></i>
            </a>
            <h4 class="mb-0">Kullanıcı Paneli</h4>
          </div>
        </div>

        <!-- İçerik Alanı -->
        <div class="container-fluid">
          <!-- Dashboard İçeriği -->
          <div id="dashboard-content" class="content-section">
            <div class="row">
              <div class="col-xl-8">
                <!-- Hoş Geldiniz Kartı -->
                <div class="card dashboard-card">
                  <div class="card-body">
                    <h4 class="card-title">
                      Hoş Geldiniz,
                      <span class="user-username-display">gozdegonul</span>!
                    </h4>
                    <p class="card-text">
                      Kut-AI psikolojik destek platformuna hoş geldiniz.
                      Aşağıdaki butondan oyunu oynayabilir veya sol menüden
                      diğer seçeneklere ulaşabilirsiniz.
                    </p>
                    <a
                      href="#oyun"
                      class="btn btn-primary mt-2"
                      data-content="oyun"
                      >Oyunu Oyna</a
                    >
                  </div>
                </div>

                <!-- Oyun Bölümü -->
                <div class="card dashboard-card">
                  <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold">Oyun</h6>
                  </div>
                  <div class="card-body p-0">
                    <div class="game-container">
                      <video autoplay muted loop playsinline>
                        <source src="video.mp4" type="video/mp4" />
                      </video>
                      <div class="overlay">
                        <h3>Psikolojik Destek Oyunu</h3>
                        <p>
                          Oyunumuzu oynayarak psikolojik durumunuz hakkında
                          bilgi sahibi olabilirsiniz.
                        </p>
                        <a
                          href="https://xn--kuta-oza.com/oyun/"
                          class="btn btn-danger game-btn"
                          id="btnoyna"
                          >Oyunu Oyna</a
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-xl-4">
                <!-- Psikolojik Durum Analizi -->
                <div class="card dashboard-card">
                  <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold">
                      Psikolojik Durum Analizi
                    </h6>
                  </div>
                  <div class="card-body">
                    <div class="mb-3">
                      <p class="small text-muted mb-1">Dışadönüklük: %25</p>
                      <div class="progress mb-3">
                        <div
                          class="progress-bar bg-danger"
                          role="progressbar"
                          style="width: 25%"
                        ></div>
                      </div>

                      <p class="small text-muted mb-1">Uyumluluk: %50</p>
                      <div class="progress mb-3">
                        <div
                          class="progress-bar bg-warning"
                          role="progressbar"
                          style="width: 50%"
                        ></div>
                      </div>

                      <p class="small text-muted mb-1">Sorumluluk: %75</p>
                      <div class="progress mb-3">
                        <div
                          class="progress-bar bg-info"
                          role="progressbar"
                          style="width: 75%"
                        ></div>
                      </div>

                      <p class="small text-muted mb-1">Duygusal Denge: %60</p>
                      <div class="progress mb-3">
                        <div
                          class="progress-bar bg-success"
                          role="progressbar"
                          style="width: 60%"
                        ></div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Son Raporlar -->
                <div class="card dashboard-card">
                  <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold">Son Raporlar</h6>
                  </div>
                  <div class="card-body">
                    <div class="list-group list-group-flush">
                      <div
                        class="list-group-item d-flex align-items-center p-2"
                      >
                        <div class="mr-3">
                          <i class="bi bi-file-text text-primary"></i>
                        </div>
                        <div class="flex-fill">
                          <div class="small">
                            Psikolojik Değerlendirme Raporu
                          </div>
                          <div class="text-muted smaller">15 Haziran 2023</div>
                        </div>
                        <button class="btn btn-sm btn-outline-primary">
                          Görüntüle
                        </button>
                      </div>
                      <div
                        class="list-group-item d-flex align-items-center p-2"
                      >
                        <div class="mr-3">
                          <i class="bi bi-file-text text-warning"></i>
                        </div>
                        <div class="flex-fill">
                          <div class="small">Terapi Süreci Değerlendirmesi</div>
                          <div class="text-muted smaller">10 Haziran 2023</div>
                        </div>
                        <button class="btn btn-sm btn-outline-primary">
                          Görüntüle
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Diğer İçerik Bölümleri (Başlangıçta Gizli) -->
          <div id="oyun-content" class="content-section d-none">
            <div class="card dashboard-card">
              <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold">Oyun</h6>
              </div>
              <div class="card-body p-0">
                <div class="game-container">
                  <video autoplay muted loop playsinline>
                    <source src="video.mp4" type="video/mp4" />
                  </video>
                  <div class="overlay">
                    <h3>Psikolojik Destek Oyunu</h3>
                    <p>
                      Oyunumuzu oynayarak psikolojik durumunuz hakkında bilgi
                      sahibi olabilirsiniz.
                    </p>
                    <a
                      href="https://xn--kuta-oza.com/oyun/"
                      class="btn btn-danger game-btn"
                      id="btnoyna2"
                      >Oyunu Oyna</a
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div id="raporlar-content" class="content-section d-none">
            <div class="d-flex justify-content-between align-items-center mb-4">
              <h4 class="mb-0">Raporlarım</h4>
              <button class="btn btn-sm btn-outline-primary">
                <i class="bi bi-download"></i> Tümünü İndir
              </button>
            </div>

            <div class="table-responsive">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Rapor Adı</th>
                    <th>Oluşturulma Tarihi</th>
                    <th>İşlemler</th>
                  </tr>
                </thead>

                <tbody></tbody>
              </table>
            </div>
            <div id="report-status-container" class="mt-4"></div>
          </div>

          <div id="analizler-content" class="content-section d-none">
            <div class="d-flex justify-content-between align-items-center mb-4">
              <h4 class="mb-0 text-start">Psikolojik Analizlerim</h4>
            </div>

            <div class="alert alert-info">
              <i class="bi bi-info-circle me-2"></i>
              Bu analiz, oyun sonunda oluşturulan psikolojik değerlendirme
              raporuna dayanmaktadır.
            </div>

            <div class="row">
              <!-- IPIP Analizi -->
              <div class="col-12 mb-4">
                <div class="card analysis-card">
                  <div class="card-header bg-white py-3">
                    <h5 class="mb-0">
                      <i class="bi bi-bar-chart trait-icon"></i> IPIP Kişilik
                      Özellikleri Analizi
                    </h5>
                  </div>
                  <div class="card-body">
                    <div class="chart-container">
                      <canvas id="ipipChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>

              <!-- GAD-7 Analizi -->
              <div class="col-md-6 mb-4">
                <div class="card analysis-card h-100">
                  <div class="card-header bg-white py-3">
                    <h5 class="mb-0">
                      <i class="bi bi-clipboard-pulse trait-icon"></i> GAD-7
                      Anksiyete Analizi
                    </h5>
                  </div>
                  <div class="card-body">
                    <div class="chart-container">
                      <canvas id="gad7Chart"></canvas>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Kariyer Önerileri -->
              <div class="col-md-6 mb-4">
                <div class="card analysis-card h-100">
                  <div class="card-header bg-white py-3">
                    <h5 class="mb-0">
                      <i class="bi bi-briefcase trait-icon"></i> Kariyer
                      Önerileri
                    </h5>
                  </div>
                  <div class="card-body">
                    <div class="radar-chart-container">
                      <canvas id="careerChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Yapay Zeka Yorumu -->
              <div class="col-12">
                <div class="card analysis-card">
                  <div class="card-header bg-white py-3">
                    <h5 class="mb-0">
                      <i class="bi bi-robot trait-icon"></i> Yapay Zeka Yorumu
                    </h5>
                  </div>
                  <div class="card-body">
                    <div class="d-flex">
                      <div class="flex-shrink-0">
                        <i class="bi bi-chat-quote display-4 text-primary"></i>
                      </div>
                      <div class="flex-grow-1 ms-3">
                        <p id="aiComment" class="mb-0 fst-italic">
                          "Analiz yükleniyor..."
                        </p>
                      </div>
                    </div>
                    <div class="mt-3 text-end">
                      <small class="text-muted"
                        >TULPAR: Kut-AI Psikolojik Analiz Sistemi</small
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div id="anketler-content" class="content-section d-none">
            <h4 class="mb-4">Mevcut Anketler</h4>

            <div class="row">
              <div class="col-md-6 mb-4">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <div
                      class="d-flex justify-content-between align-items-start mb-3"
                    >
                      <h5 class="card-title mb-0">Depresyon Tarama Testi</h5>
                      <span class="badge bg-success">Tamamlandı</span>
                    </div>
                    <p class="card-text text-muted small">
                      Son tamamlanma: 15.06.2023
                    </p>
                    <div class="progress mb-3" style="height: 6px">
                      <div
                        class="progress-bar bg-success"
                        role="progressbar"
                        style="width: 100%"
                      ></div>
                    </div>
                    <a href="#" class="btn btn-sm btn-outline-primary"
                      >Sonuçları Görüntüle</a
                    >
                    <a href="#" class="btn btn-sm btn-outline-secondary ms-2"
                      >Testi Tekrarla</a
                    >
                  </div>
                </div>
              </div>

              <div class="col-md-6 mb-4">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <div
                      class="d-flex justify-content-between align-items-start mb-3"
                    >
                      <h5 class="card-title mb-0">Anksiyete Ölçeği</h5>
                      <span class="badge bg-warning text-dark"
                        >Devam Ediyor</span
                      >
                    </div>
                    <p class="card-text text-muted small">
                      Son güncelleme: 20.06.2023
                    </p>
                    <div class="progress mb-3" style="height: 6px">
                      <div
                        class="progress-bar bg-warning"
                        role="progressbar"
                        style="width: 65%"
                      ></div>
                    </div>
                    <a href="#" class="btn btn-sm btn-primary"
                      >Teste Devam Et</a
                    >
                  </div>
                </div>
              </div>

              <div class="col-md-6 mb-4">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <div
                      class="d-flex justify-content-between align-items-start mb-3"
                    >
                      <h5 class="card-title mb-0">Kişilik Envanteri</h5>
                      <span class="badge bg-danger">Başlanmadı</span>
                    </div>
                    <p class="card-text text-muted small">Son erişim: Hiç</p>
                    <div class="progress mb-3" style="height: 6px">
                      <div
                        class="progress-bar bg-danger"
                        role="progressbar"
                        style="width: 0%"
                      ></div>
                    </div>
                    <a href="#" class="btn btn-sm btn-danger">Teste Başla</a>
                  </div>
                </div>
              </div>

              <div class="col-md-6 mb-4">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <div
                      class="d-flex justify-content-between align-items-start mb-3"
                    >
                      <h5 class="card-title mb-0">Stres Düzeyi Testi</h5>
                      <span class="badge bg-success">Tamamlandı</span>
                    </div>
                    <p class="card-text text-muted small">
                      Son tamamlanma: 10.06.2023
                    </p>
                    <div class="progress mb-3" style="height: 6px">
                      <div
                        class="progress-bar bg-success"
                        role="progressbar"
                        style="width: 100%"
                      ></div>
                    </div>
                    <a href="#" class="btn btn-sm btn-outline-primary"
                      >Sonuçları Görüntüle</a
                    >
                    <a href="#" class="btn btn-sm btn-outline-secondary ms-2"
                      >Testi Tekrarla</a
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div id="ayarlar-content" class="content-section d-none">
            <div class="card dashboard-card">
              <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold">Hesap Ayarları</h6>
              </div>
              <div class="card-body">
                <form>
                  <div class="row mb-3">
                    <div class="col-md-6">
                      <label for="firstName" class="form-label">Ad</label>
                      <input
                        type="text"
                        class="form-control"
                        id="firstName"
                        value="Gözde"
                      />
                    </div>
                    <div class="col-md-6">
                      <label for="lastName" class="form-label">Soyad</label>
                      <input
                        type="text"
                        class="form-control"
                        id="lastName"
                        value="Gönül"
                      />
                    </div>
                  </div>
                  <div class="mb-3">
                    <label for="email" class="form-label">E-posta</label>
                    <input
                      type="email"
                      class="form-control"
                      id="email"
                      value="gozde.gonul@example.com"
                    />
                  </div>
                  <div class="mb-3">
                    <label for="password" class="form-label">Yeni Şifre</label>
                    <input
                      type="password"
                      class="form-control"
                      id="password"
                      placeholder="Şifrenizi değiştirmek için buraya yazın"
                    />
                  </div>
                  <div class="mb-3">
                    <label for="confirmPassword" class="form-label"
                      >Şifreyi Onayla</label
                    >
                    <input
                      type="password"
                      class="form-control"
                      id="confirmPassword"
                      placeholder="Yeni şifrenizi tekrar girin"
                    />
                  </div>
                  <button type="submit" class="btn btn-primary">
                    Değişiklikleri Kaydet
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // ==========================================================
        // GİRİŞ YAPAN KULLANICI BİLGİLERİNİ SAYFAYA YAZDIRMA
        // ==========================================================
        const loggedInUsername = localStorage.getItem("username");
        const loggedInUserEmail = localStorage.getItem("userEmail");

        if (loggedInUsername) {
          // Sidebar'daki ismi bul ve güncelle
          const sidebarNameElements = document.querySelectorAll(
            ".user-username-display"
          );
          sidebarNameElements.forEach((el) => {
            el.textContent = loggedInUsername;
          });

          // Navbar'daki butonun metnini güncelle
          const dropdownButton = document.getElementById("dropdownMenuButton");
          if (dropdownButton) {
            dropdownButton.innerHTML = `<i class="bi bi-person-circle me-1"></i> ${loggedInUsername}`;
          }
        }

        // ==========================================================
        // ÇIKIŞ YAPMA İŞLEVSELLİĞİ
        // ==========================================================
        const logoutLink = document.getElementById("logout-link");
        if (logoutLink) {
          logoutLink.addEventListener("click", function (event) {
            event.preventDefault();
            localStorage.clear();
            alert("Başarıyla çıkış yaptınız.");
            window.location.href = "index.html";
          });
        }

        // ==========================================================
        // OYUN OYNAMA BUTONU İŞLEVSELLİĞİ
        // ==========================================================
        const oynaButonlari = document.querySelectorAll("#btnoyna, #btnoyna2");
        oynaButonlari.forEach((btn) => {
          btn.addEventListener("click", function () {
            const loggedInUserId = localStorage.getItem("userId");
            if (loggedInUserId) {
              const baseUrl = window.location.origin;
              window.location.href = `${baseUrl}/oyun?userId=${loggedInUserId}`;
            } else {
              alert("Oyun oynamak için giriş yapmalısınız.");
              window.location.href = "index.html";
            }
          });
        });

        // ==========================================================
        // SIDEBAR NAVİGASYON
        // ==========================================================
        const navLinks = document.querySelectorAll(
          ".sidebar-nav a[data-content]"
        );
        const contentSections = document.querySelectorAll(".content-section");

        navLinks.forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();

            // Aktif linki güncelle
            navLinks.forEach((l) => l.classList.remove("active"));
            this.classList.add("active");

            // İlgili içeriği göster, diğerlerini gizle
            const targetContent = this.getAttribute("data-content");
            contentSections.forEach((section) => {
              section.classList.add("d-none");
            });
            document
              .getElementById(`${targetContent}-content`)
              .classList.remove("d-none");
          });
        });

        // ==========================================================
        // PSİKOLOJİK RAPOR GÖRÜNTÜLEME İŞLEVSELLİĞİ
        // ==========================================================
        const viewReportButton = document.getElementById(
          "view-psychology-report-btn"
        );
        const reportStatusContainer = document.getElementById(
          "report-status-container"
        );

        if (viewReportButton && reportStatusContainer) {
          viewReportButton.addEventListener("click", async () => {
            const currentUserId = localStorage.getItem("userId");

            if (!currentUserId) {
              alert("Bu işlem için giriş yapmış olmalısınız.");
              return;
            }

            viewReportButton.disabled = true;
            viewReportButton.innerHTML =
              '<span class="spinner-border spinner-border-sm"></span> Aranıyor...';
            reportStatusContainer.innerHTML = "";

            try {
              const response = await fetch(
                "/.netlify/functions/generate-report",
                {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify({ playerId: currentUserId }),
                }
              );

              const result = await response.json();

              if (response.ok && result.success) {
                reportStatusContainer.innerHTML = `
                                <div class="alert alert-success d-flex justify-content-between align-items-center">
                                    <span>${result.message}</span>
                                    <a href="${result.pdfLink}" target="_blank" class="btn btn-success btn-sm">PDF'i Aç</a>
                                </div>
                            `;
              } else {
                reportStatusContainer.innerHTML = `
                                <div class="alert alert-warning">${
                                  result.message || "Bir hata oluştu."
                                }</div>
                            `;
              }
            } catch (error) {
              reportStatusContainer.innerHTML = `
                            <div class="alert alert-danger">Sunucu ile iletişim kurulamadı. Lütfen tekrar deneyin.</div>
                        `;
            } finally {
              viewReportButton.disabled = false;
              viewReportButton.innerHTML = "Görüntüle";
            }
          });
        }

        // ==========================================================
        // RAPORLARIM TABLOSUNU DOLDURMA
        // ==========================================================
        async function loadReports() {
          const username = localStorage.getItem("username");
          if (!username) return;

          try {
            const response = await fetch(
              `https://unity-choice-api-production-8a70.up.railway.app/api/user-report/${username}`
            );
            const data = await response.json();

            // API'den raporların geldiğini kontrol et
            const reports = data.reports || [];
            const tbody = document.querySelector("#raporlar-content tbody");
            tbody.innerHTML = ""; // önce tabloyu temizle

            if (reports.length > 0) {
              reports.forEach((report, index) => {
                const createdDate = report.generatedAt
                  ? new Date(report.generatedAt).toLocaleDateString("tr-TR")
                  : "--";

                const row = `
          <tr>
            <td>${report.name || "Psikolojik Rapor " + (index + 1)}</td>
            <td>${createdDate}</td>
            <td>
              <a href="${
                report.reportLink
              }" target="_blank" class="btn btn-sm btn-outline-primary">
                Görüntüle
              </a>
            </td>
          </tr>
        `;
                tbody.insertAdjacentHTML("beforeend", row);
              });
            } else {
              tbody.innerHTML = `
        <tr>
          <td colspan="3" class="text-center text-muted">Hiç rapor bulunamadı.</td>
        </tr>
      `;
            }
          } catch (err) {
            console.error("Rapor yükleme hatası:", err);
          }
        }

        // Sayfa açıldığında raporları yükle
        loadReports();

        // ==========================================================
        //  ANALİZ BUTONU
        // ==========================================================

        // IPIP Kişilik Özellikleri Grafiği
        // IPIP Kişilik Özellikleri Grafiği
        const ipipCtx = document.getElementById("ipipChart").getContext("2d");
        const ipipChart = new Chart(ipipCtx, {
          type: "bar",
          data: {
            labels: [
              "Nevrotiklik",
              "Dışadönüklük",
              "Açıklık",
              "Uyumluluk",
              "Vicdanlılık",
            ],
            datasets: [
              {
                label: "Seviye (%)",
                data: [68, 42, 55, 76, 63],
                backgroundColor: [
                  "rgba(231, 74, 59, 0.7)",
                  "rgba(78, 115, 223, 0.7)",
                  "rgba(246, 194, 62, 0.7)",
                  "rgba(28, 200, 138, 0.7)",
                  "rgba(54, 185, 204, 0.7)",
                ],
                borderColor: [
                  "rgba(231, 74, 59, 1)",
                  "rgba(78, 115, 223, 1)",
                  "rgba(246, 194, 62, 1)",
                  "rgba(28, 200, 138, 1)",
                  "rgba(54, 185, 204, 1)",
                ],
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
                max: 100,
                ticks: {
                  callback: function (value) {
                    return value + "%";
                  },
                },
              },
            },
            plugins: {
              legend: {
                display: false,
              },
            },
          },
        });

        // GAD-7 Anksiyete Grafiği
        const gad7Ctx = document.getElementById("gad7Chart").getContext("2d");
        const gad7Chart = new Chart(gad7Ctx, {
          type: "doughnut",
          data: {
            labels: ["Hafif", "Orta", "Şiddetli"],
            datasets: [
              {
                data: [30, 50, 20],
                backgroundColor: [
                  "rgba(28, 200, 138, 0.7)",
                  "rgba(246, 194, 62, 0.7)",
                  "rgba(231, 74, 59, 0.7)",
                ],
                borderColor: [
                  "rgba(28, 200, 138, 1)",
                  "rgba(246, 194, 62, 1)",
                  "rgba(231, 74, 59, 1)",
                ],
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: "70%",
            plugins: {
              legend: {
                position: "bottom",
              },
            },
          },
        });

        // Kariyer Önerileri Radar Grafiği
        const careerCtx = document
          .getElementById("careerChart")
          .getContext("2d");
        const careerChart = new Chart(careerCtx, {
          type: "radar",
          data: {
            labels: [
              "Sosyal Beceri",
              "Analitik Düşünce",
              "Yaratıcılık",
              "Liderlik",
              "Empati",
            ],
            datasets: [
              {
                label: "Mevcut Seviye",
                data: [75, 60, 55, 50, 80],
                backgroundColor: "rgba(78, 115, 223, 0.2)",
                borderColor: "rgba(78, 115, 223, 1)",
                pointBackgroundColor: "rgba(78, 115, 223, 1)",
                pointBorderColor: "#fff",
                pointHoverBackgroundColor: "#fff",
                pointHoverBorderColor: "rgba(78, 115, 223, 1)",
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              r: {
                angleLines: {
                  display: true,
                },
                suggestedMin: 0,
                suggestedMax: 100,
              },
            },
          },
        });

        if (loggedInUsername) {
          const sidebarNameElement =
            document.querySelector(".user-name-display");
          if (sidebarNameElement) {
            sidebarNameElement.textContent = loggedInUsername;
          }

          const dropdownButton = document.getElementById("dropdownMenuButton");
          if (dropdownButton) {
            dropdownButton.innerHTML = `<i class="bi bi-person-circle me-1"></i> ${loggedInUsername}`;
          }
        }

        if (loggedInUserEmail) {
          const emailElement = document.querySelector(".user-email-display");
          if (emailElement) {
            emailElement.textContent = loggedInUserEmail;
          }
        }
      });
    </script>
  </body>
</html>
